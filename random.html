<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Random HT22</title>
    <link rel="stylesheet" href="random.css" />
    <script rel="" type="text/javascript" src="random.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.js"></script>
  </head>
  <body>
    <div>
      <div class="parent_h1">
        <h1>Random nhóm HT22</h1>
      </div>
      <div class="random">
        <div class="random">
          <div class="parent-btn">
            <input type="text" placeholder="Nhập tên sinh viên" />
            <button id="add">Nhập</button>
          </div>
          <div class="parent-ol">
            <ol class="text" id="group1">
              1.Phóng mặt loz
            </ol>
            <ol class="text" id="group2">
              2.Khang bí thư
            </ol>
            <ol class="text" id="group3">
              3.Tiến Thành
            </ol>
            <ol class="text" id="group4">
              4.Minh Tùng
            </ol>
            <ol class="text" id="group5">
              5.Phương Anh
            </ol>
            <ol class="text" id="group6">
              6.Mạnh Tú
            </ol>
            <ol class="text" id="group7">
              7.Dương biển
            </ol>
            <ol class="text" id="group8">
              8.Anh Tú
            </ol>
            <ol class="text" id="group9">
              9.Tùng fake
            </ol>
            <ol class="text" id="group10">
              10. Đức Anh
            </ol>
          </div>

          <script>
            $(function () {
              $("#add").on("click", function () {
                // tạo biến val lưu giá trị thẻ input
                let val = $("input").val();
                // các biến num lưu số thẻ con của class group...
                let group1 = $("#group1").children().length;
                let group2 = $("#group2").children().length;
                let group3 = $("#group3").children().length;
                let group4 = $("#group4").children().length;
                let group5 = $("#group5").children().length;
                let group6 = $("#group6").children().length;
                let group7 = $("#group7").children().length;
                let group8 = $("#group8").children().length;
                let group9 = $("#group9").children().length;
                let group10 = $("#group10").children().length;
                // tạo mảng chứa số phần tử từng nhóm
                let array_gr_old = [
                  ["group1", group1],
                  ["group2", group2],
                  ["group3", group3],
                  ["group4", group4],
                  ["group5", group5],
                  ["group6", group6],
                  ["group7", group7],
                  ["group8", group8],
                  ["group9", group9],
                  ["group10", group10],
                ];
                // Nhóm mới chứa value
                let array_gr_new = [];
                // Nhóm cá biệt chứa value cá biệt
                let array_gr_cabiet = [];
                console.log(array_gr_old);
                console.log("------------------");
                // loại bỏ phần tử có value = 4 trong array_gr_old
                for (let [key, value] of array_gr_old) {
                  if (value < 4) {
                    if (key != "group4" && key != "group9") {
                      array_gr_new.push(key);
                      if (key != "group8") {
                        array_gr_cabiet.push(key);
                      }
                    }
                  }
                }
                console.log(array_gr_new);
                // điều kiện thẻ input nếu có giá trị value
                if (val !== "") {
                  // gọi hàm random số thứ tự
                  var num = () => {
                    // Nếu nhóm 4 còn chỗ
                    if (group4 < 4) {
                      if (
                        val == "Hoàng Đức Minh" ||
                        val == "Hồ Tiến Quân" ||
                        val == "Vũ Thị Ngát" ||
                        val == "Bùi Thị Hà"
                      ) {
                        return "group4";
                      }
                    }

                    // Nếu nhóm 9 còn chỗ
                    if (group9 < 4) {
                      if (
                        val == "Tạ Thanh Tâm" ||
                        val == "Bùi Thị Yến" ||
                        val == "Trịnh Quốc Hưng" ||
                        val == "Khuất Quang Sáng"
                      ) {
                        return "group9";
                      }
                    }

                    // Nếu nhóm 6 còn chỗ
                    if (array_gr_new.indexOf("group6") != -1) {
                      if (val == "Bùi Thị Thảo") {
                        return "group6";
                      }
                    }

                    //Nhóm đặc biệt sẽ phải loại trừ, chạy random trong mảng cá biệt
                    if (
                      val == "Nguyễn Kim Huy" ||
                      val == "Lã Việt Tùng" ||
                      val == "Ngô Hoàng Thiện Đức" ||
                      val == "Vũ Duy Khánh" ||
                      val == "Nguyễn Minh Đức" ||
                      val == "Nguyễn Thế Quang" ||
                      val == "Lã Tiến Việt" ||
                      val == "Ngô Xuân Hoàng" ||
                      val == "Nguyễn Văn Đạt"
                    ) {
                      return array_gr_cabiet[
                        Math.floor(Math.random() * (array_gr_cabiet.length - 1))
                      ];
                    }
                    // Nếu không thỏa mãn 2 điêu kiện trên
                    return array_gr_new[
                      Math.floor(Math.random() * (array_gr_new.length - 1))
                    ];
                  };
                  var n = num();
                  // tạo biến elem đại diện cho thẻ li có text là giá tri trị val(input)
                  var elem = $("<li></li>").text(val);
                  // thêm button X vào sau thẻ elem
                  $(elem).append("<button class='rem'>X</button>");
                  // điều kiện xếp nhóm theo số thứ tự
                  if (n == "group1") {
                    $("#group1").append(elem);
                  } else if (n == "group2") {
                    $("#group2").append(elem);
                  } else if (n == "group3") {
                    $("#group3").append(elem);
                  } else if (n == "group4") {
                    $("#group4").append(elem);
                  } else if (n == "group5") {
                    $("#group5").append(elem);
                  } else if (n == "group6") {
                    $("#group6").append(elem);
                  } else if (n == "group7") {
                    $("#group7").append(elem);
                  } else if (n == "group8") {
                    $("#group8").append(elem);
                  } else if (n == "group9") {
                    $("#group9").append(elem);
                  } else if (n == "group10") {
                    $("#group10").append(elem);
                  }
                  $("input").val("");
                  $(".rem").on("click", function () {
                    $(this).parent().remove();
                  });
                }
              });
            });
          </script>
        </div>
      </div>
    </div>
  </body>
</html>
